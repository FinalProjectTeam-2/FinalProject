<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.finalproject.festival.mapper.ReservationMapper" >
	
	<!--  장바구니 목록보기 mysql OK -->
	<select id="reservationList" resultType="hashmap"  parameterType="Map">
	SELECT
    R.reservationno,
    R.id AS id,
    R.productno AS productno,
    R.reservationprice,
    R.reservationticketcount AS ticketcount,
    R.reservationdate,
    R.totalReservationPrice,
    R.salesTotalPrice,
    SB.basketno,
    SB.basketproductcount,
    P.productname,
    P.productcontent,
    P.productimage,
    P.productlocation,
    P.productopendate,
    P.productclosedate,
    P.productbookmarkcount,
    P.productreadcount,
    P.productticketcount,
    P.productremainticketcount,
    P.productprice,
    M.password,
    M.name,
    M.phonenumber,
    M.email,
    M.totalpay,
    M.grade,
    M.joindate,
    M.address1,
    M.address2,
    M.zipcode
FROM Reservation R
JOIN Member M ON R.id = M.id
LEFT JOIN ShoppingBasket SB ON R.id = SB.id AND R.productno = SB.productno 
AND R.reservationticketcount = SB.basketproductcount
LEFT JOIN Product P ON R.productno = P.productno
WHERE R.id = #{id}
	</select>

	
	<resultMap id="ReservationResultMap" type="Reservation" >
		<id property="reservationno" column="reservationno" />
		<result property="productno" column="productno" />
		<result property="id" column="id" />
		<result property="reservationticketcount" column="reservationticketcount" />
		<result property="reservationprice" column="reservationprice" />
	</resultMap>
	
</mapper>	



