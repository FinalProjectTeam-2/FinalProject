<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.finalproject.festival.mapper.MemberMapper" >

	<select id="userCheck" resultType="Member"  >
		SELECT * From Member WHERE id = #{id} OR email = #{email}
	</select>
	
	<select id="userCount" resultType="Integer"  >
		SELECT COUNT(*)  From Member WHERE id = #{id} OR email = #{email}
	</select>
	
	<select id="userFindId" resultType="Integer" parameterType="hashMap">
		SELECT COUNT(*) FROM Member WHERE name = #{name} AND email = #{email}	
	</select>
	
	<select id="userFindPassword" resultType="Integer" parameterType="hashMap">
		SELECT COUNT(*) FROM Member WHERE id = #{id} AND email = #{email}	
	</select>
	
	<select id="userLogin" resultType="hashMap" >
		 SELECT 'Member' AS userType, id, name, phonenumber, email, totalpay, grade, password
	    FROM Member
	    WHERE id = #{id}
	    UNION ALL
	    SELECT 'Admin' AS userType, adminid AS id, adminname AS name, NULL AS phonenumber, NULL AS email, NULL AS totalpay, NULL AS grade, adminpassword AS password
	    FROM Admin
	    WHERE adminid = #{id}
		
	</select>

	<insert id="joinMember" parameterType="Member">
		INSERT INTO Member (name, id, phonenumber, password, zipcode,address1,address2,email,joindate,totalpay,grade) 
					VALUES(#{name},#{id},#{phonenumber},#{password},#{zipcode},
									#{address1},#{address2},#{email},SYSDATE(),0,0)
	</insert>
	
	<update id="userNewPassword"  parameterType="hashMap" >
    	UPDATE Member SET password = #{password} WHERE id = #{id}
	</update>
	
				<!--************** admin ****************-->
	
	<insert id="adminUserAdd" parameterType="hashMap">
	INSERT INTO Admin (adminname,adminid,adminpassword) 
					VALUES(#{adminname},#{adminid},#{adminpassword})
	</insert>
	<select id="adminUserSelect" resultType="Admin">
		SELECT * FROM Admin;
	</select>
	
	
</mapper>	



